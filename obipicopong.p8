pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
--obipicopong
score = 0
hiscore = 0
is_gameover = false

function _init()
 -- p = player
	p={
	 x=2,
	 y=64,
	 w=2,
	 h=20,
	}
	
	-- o = opponent
	o={
	 x=124,
	 y=64,
	 w=2,
	 h=20
	}
	
	ball={}
	ball_reset(ball)
	
	music(0)
end

function _update60()
	if (isgameover) then
	 if (btn(❎)) then
	  isgameover = false
	  score = 0
	  ball_reset(ball)
	 end
	 return
	end
	player_update()
	ball_update()
	opponent_update()
	particles_update()
end

function _draw()
	cls(1)	
	
	particles_draw()
	
	print("obipicopong", 44,34,0)
	print("score: "..score, 44, 44,3)
	print("hiscore:"..hiscore, 44, 64,2)
	if (isgameover) then
		print("press ❎ to restart", 24, 24,4)
	end
	 

	rectfill(p.x,p.y,p.x+p.w,p.y+p.h,7)
	rectfill(o.x,o.y,o.x+o.w,o.y+o.h,7)
	circfill(ball.x,ball.y,ball.size,12)
	
end	
-->8
-- player
function player_update()
 player_move()
 player_bounds()
end

function player_move()
	if btn(⬇️) then
		p.y+=3
	end
	if btn(⬆️) then
		p.y-=3
	end
end

function player_bounds()
	if p.y<0 then
	 p.y = 0
	end
	if p.y>128-p.h then
	 p.y = 128-p.h
	end
end
-->8
-- ball
function ball_update()
 ball_move()
 ball_bounce()
end

function ball_move()
	ball.x+=ball.vx
	ball.y+=ball.vy
end

function ball_reset(ball)
	ball.x=64
	ball.y=64
	ball.size=2
	ball.vx=1
 ball.vy=2
end

function ball_bounce()
	if(ball.y>128 or ball.y<0) then
	 ball.vy*=-1
	 particle_start(ball.x, ball.y,3,5) 
	end
	
	-- bounce at player
	 if(ball.y>=p.y and
    ball.y<=p.y+p.h and
    ball.x==p.x+p.w)then
  ball.vx*=-1  
  score+=1
  particle_start(ball.x, ball.y,5,12) 
  sfx(0)
 end
 
 -- bounce at opponent
  if(ball.y>=o.y and
    ball.y<=o.y+o.h and
    ball.x==o.x)then
  ball.vx*=-1
  ball.vy=rnd(6)-3 
  score+=1
  particle_start(ball.x, ball.y,5,12) 
  sfx(0)
 end
 
 if (ball.x < 0) then 
  isgameover=true
  if (score > hiscore) hiscore = score
 end
end
-->8
-- opponent
function opponent_update()
 opponent_move()
 opponent_bounds()
end

function opponent_move()
 o.y = ball.y - o.h/2
end

function opponent_bounds()
	if o.y<0 then
	 o.y = 0
	end
	if o.y>128-o.h then
	 o.y = 128-o.h
	end
end
-->8
-- particles
sparks={}

for i=1,200 do
 add(sparks, {
 x=0,
 y=0,
 vx=0,
 vy=0,
 r=0,
 alive=false,
 mass=0 
 })
end

function particle_start(x,y,r,particles)
	local selected = 0
	for i=1,#sparks do
	 if not sparks[i].alive then
	  sparks[i].x = x
	  sparks[i].y = y
	  sparks[i].vely = -1 + rnd(2)
	  sparks[i].velx = -1 + rnd(2)
	  sparks[i].mass = 0.5 + rnd(2)
	  sparks[i].r = 0.5 + rnd(r)
	  sparks[i].alive = true
	  selected += 1
	  if selected == particles then
	  break end
	 end
	end
end

function particles_update()
 for i=1,#sparks do
  if sparks[i].alive then
   sparks[i].x+=sparks[i].velx /sparks[i].mass
   sparks[i].y+=sparks[i].vely /sparks[i].mass
		 sparks[i].r-= 0.1
		 if sparks[i].r < 0.1 then
		  sparks[i].alive = false
		 end
		end
	end
end

function particles_draw()
 for i=1,#sparks do
  if sparks[i].alive then
   circfill(
   sparks[i].x,
   sparks[i].y,
   sparks[i].r,
   10
   )
  end
 end 
end 
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111100100010001000100011001100100011001001110011111111111111111111111111111111111111111
11111111111111111111111111111111111111111111010101011011010110110111010101010101010101111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111010100111011000110110111010100010101010101111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111010101011011011110110111010101110101010101011111111111111111111111111111111111111111
11111111111111111111111111111111111111111111001100010001011100011001001101110011010100011111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111133113311331333133311111111133111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111311131113131313131111311111113111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111333131113131331133111111111113111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111113131113131313131111311111113111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111331113313311313133311111111133311111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111212122211221122112212221222111112221111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111212112112111211121212121211112112121111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111222112112221211121212211221111112121111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111212112111121211121212121211112112121111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111212122212211122122112121222111112221111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11777111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111119991111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111199999111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111199999111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111199999111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111119991111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111117771
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111

__map__
0000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00010000150101f010270102d01031010330102a0100c010080100a01011010220101001008010040100201001010010100000000000000000000000000000000000000000000000000000000000000000000000
001100001d010000001f0100000021010000001d010000001d010000001f0100000021010000001d010000001f010000001a010000001d01000000210100000018010000001a010000001c0101c0101c0101c010
__music__
00 01424344

